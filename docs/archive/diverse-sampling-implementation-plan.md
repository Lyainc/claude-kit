# Diverse Sampling Skill Implementation Plan

## Overview

Verbalized Sampling(VS) ê¸°ë²•ì„ í™œìš©í•œ ë‹¤ì–‘ì„± í–¥ìƒ ìŠ¤í‚¬ êµ¬í˜„ ê³„íšì„œ.

**Based on**: [arXiv:2510.01171](https://arxiv.org/abs/2510.01171) - Zhang et al., 2025

## Requirements Summary

| í•­ëª© | ê²°ì • ì‚¬í•­ |
|------|-----------|
| íŒŒë¼ë¯¸í„° ë…¸ì¶œ | âŒ ë‚´ë¶€ ê³ ì • (k=5, tau=0.10) |
| ë‹¤êµ­ì–´ ì§€ì› | âœ… ì…ë ¥ ì–¸ì–´ ìë™ ê°ì§€ â†’ í•´ë‹¹ ì–¸ì–´ë¡œ ì¶œë ¥ |
| í”¼ë“œë°± ë£¨í”„ | ğŸŸ¡ ê°€ëŠ¥í•˜ë©´ êµ¬í˜„, ì–´ë ¤ìš°ë©´ ë³´ë¥˜ |
| í˜¸ì¶œ ë°©ì‹ | ëª…ì‹œì  â†’ ì¦‰ì‹œ ì‹¤í–‰ / ë¬µì‹œì  â†’ AskUserQuestion í™•ì¸ |
| Fallback | âœ… í•„ìˆ˜ êµ¬í˜„ |

---

## 1. Skill Structure

```
template/skills/diverse-sampling/
â”œâ”€â”€ SKILL.md           # í•µì‹¬ ì›Œí¬í”Œë¡œìš°
â”œâ”€â”€ reference.md       # ìƒì„¸ ì ˆì°¨, í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿
â””â”€â”€ examples.md        # ì‚¬ìš© ì˜ˆì‹œ
```

---

## 2. Core Components

### 2.1 Invocation Detection

| Type | Trigger | Action |
|------|---------|--------|
| **Explicit** | `/diverse-sampling`, "diverse samplingìœ¼ë¡œ", "VS ê¸°ë²•ìœ¼ë¡œ" | ì¦‰ì‹œ ì‹¤í–‰ |
| **Implicit** | "ë‹¤ì–‘í•œ ì•„ì´ë””ì–´", "ì—¬ëŸ¬ ê´€ì ", "ë¸Œë ˆì¸ìŠ¤í† ë°" | AskUserQuestionìœ¼ë¡œ í™•ì¸ |

**Implicit í™•ì¸ í”„ë¡¬í”„íŠ¸**:
```
ë‹¤ì–‘ì„± í–¥ìƒ ê¸°ë²•(Verbalized Sampling)ì„ ì ìš©í• ê¹Œìš”?
- ì—¬ëŸ¬ ëŒ€ì•ˆì„ ìƒì„±í•˜ì—¬ ê·¸ ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•©ë‹ˆë‹¤
- ì°½ì˜ì  ì‘ì—…ì— íš¨ê³¼ì ì´ì§€ë§Œ í† í° ì†Œë¹„ê°€ ë†’ìŠµë‹ˆë‹¤
```

### 2.2 Language Detection

```
Phase 0ì—ì„œ ì…ë ¥ ì–¸ì–´ ê°ì§€:
- Korean detected â†’ í•œêµ­ì–´ VS í”„ë¡¬í”„íŠ¸ ì‚¬ìš©
- English detected â†’ English VS prompt ì‚¬ìš©
- Mixed â†’ ì§€ë°°ì  ì–¸ì–´ ë”°ë¦„
```

### 2.3 VS Prompt Templates

**English**:
```
Generate 5 responses to the following query, each within a separate <response> tag.
Each <response> must include:
- <text>: The actual response content
- <probability>: A numeric probability (0.0-1.0)

Sample from the tails of the distribution, such that each probability is less than 0.10.

Query: {USER_QUERY}
```

**Korean**:
```
ë‹¤ìŒ ì§ˆë¬¸ì— ëŒ€í•´ 5ê°œì˜ ì‘ë‹µì„ ìƒì„±í•˜ì„¸ìš”. ê° ì‘ë‹µì€ ë³„ë„ì˜ <response> íƒœê·¸ ì•ˆì— ì‘ì„±í•©ë‹ˆë‹¤.
ê° <response>ëŠ” ë‹¤ìŒì„ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤:
- <text>: ì‹¤ì œ ì‘ë‹µ ë‚´ìš©
- <probability>: í™•ë¥ ê°’ (0.0-1.0)

ë¶„í¬ì˜ ê¼¬ë¦¬ì—ì„œ ìƒ˜í”Œë§í•˜ì—¬, ê° í™•ë¥ ì´ 0.10 ë¯¸ë§Œì´ ë˜ë„ë¡ í•˜ì„¸ìš”.

ì§ˆë¬¸: {USER_QUERY}
```

### 2.4 Output Selection Strategy

| Option | Behavior | Default |
|--------|----------|---------|
| (default) | Weighted random sampling â†’ 1ê°œ ì¶œë ¥ | âœ… |
| `--all` | 5ê°œ ì „ì²´ í‘œì‹œ (í™•ë¥  í¬í•¨) | |
| `--best` | ìµœê³  í™•ë¥  ì„ íƒ | |

### 2.5 Fallback Mechanism

```
VS ì‹¤í–‰ ì‹¤íŒ¨ ì‹œ (íŒŒì‹± ì˜¤ë¥˜, í˜•ì‹ ë¶ˆì¼ì¹˜ ë“±):
1. ê²½ê³  ë©”ì‹œì§€ ì¶œë ¥: "VS í˜•ì‹ íŒŒì‹± ì‹¤íŒ¨, ì¼ë°˜ ì‘ë‹µìœ¼ë¡œ ì „í™˜í•©ë‹ˆë‹¤"
2. ë™ì¼ ì¿¼ë¦¬ë¡œ ì¼ë°˜ ì‘ë‹µ ìƒì„±
3. ê²°ê³¼ ë°˜í™˜
```

---

## 3. Workflow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 0: Preparation                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. í˜¸ì¶œ ìœ í˜• íŒë‹¨ (Explicit / Implicit)                 â”‚
â”‚ 2. Implicitì¸ ê²½ìš° â†’ AskUserQuestion                    â”‚
â”‚ 3. ì…ë ¥ ì–¸ì–´ ê°ì§€                                       â”‚
â”‚ 4. Use Case ì í•©ì„± ê²€ì¦                                 â”‚
â”‚    - ì°½ì˜ì  ì‘ì—… âœ… â†’ ì§„í–‰                              â”‚
â”‚    - ì‚¬ì‹¤ ì§ˆë¬¸/ì½”ë“œ âŒ â†’ ì¼ë°˜ ì‘ë‹µ ê¶Œê³                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 1: VS Generation                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. ì–¸ì–´ë³„ VS í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ì ìš©                       â”‚
â”‚ 2. 5ê°œ ì‘ë‹µ + í™•ë¥  ìƒì„±                                 â”‚
â”‚ 3. XML íŒŒì‹± ì‹œë„                                        â”‚
â”‚    - ì„±ê³µ â†’ Phase 2                                     â”‚
â”‚    - ì‹¤íŒ¨ â†’ Fallback                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 2: Selection                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì˜µì…˜ì— ë”°ë¼:                                            â”‚
â”‚ - default: weighted random sampling                     â”‚
â”‚ - --all: ì „ì²´ í‘œì‹œ                                      â”‚
â”‚ - --best: ìµœê³  í™•ë¥  ì„ íƒ                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 3: Output                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. ì„ íƒëœ ì‘ë‹µ ì¶œë ¥                                     â”‚
â”‚ 2. (--allì¸ ê²½ìš°) ì „ì²´ ëª©ë¡ + í™•ë¥  í‘œì‹œ                 â”‚
â”‚ 3. ë©”íƒ€ ì •ë³´ (ì„ íƒ ë°©ì‹, ì–¸ì–´) í‘œì‹œ                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Use Case Boundaries

### ì ìš© ëŒ€ìƒ (Apply)

- ë¸Œë ˆì¸ìŠ¤í† ë°, ì•„ì´ë””ì–´ ë°œì‚°
- ì°½ì˜ì  ê¸€ì“°ê¸° (ìŠ¤í† ë¦¬, ì‹œ, ë†ë‹´, ì¹´í”¼)
- ëŒ€ì•ˆ/ì˜µì…˜ ì œì‹œ
- í•©ì„± ë°ì´í„° ìƒì„±
- ëŒ€í™” ì‹œë®¬ë ˆì´ì…˜

### ì œì™¸ ëŒ€ìƒ (Exclude)

- ì‚¬ì‹¤ ê¸°ë°˜ ì§ˆë¬¸ ("í•œêµ­ì˜ ìˆ˜ë„ëŠ”?")
- ì½”ë“œ ë””ë²„ê¹…/ìˆ˜ì •
- ë‹¨ì¼ ì •ë‹µì´ ìˆëŠ” ì‘ì—…
- ì •ë°€í•œ ê³„ì‚°/ë¶„ì„

---

## 5. Feedback Loop (Optional)

**êµ¬í˜„ ê°€ëŠ¥ ì‹œ**:
```
ì‚¬ìš©ìê°€ --allë¡œ ì „ì²´ ë³´ê¸° í›„ íŠ¹ì • ì‘ë‹µ ì„ íƒ ì‹œ:
1. ì„ íƒëœ ì‘ë‹µ ID ê¸°ë¡
2. ì„¸ì…˜ ë‚´ ì„ í˜¸ë„ íŒ¨í„´ í•™ìŠµ
3. ë‹¤ìŒ VS í˜¸ì¶œ ì‹œ ì„ í˜¸ë„ ë°˜ì˜ (optional)
```

**MVPì—ì„œ ì œì™¸ ì‹œ**:
- ë‹¨ìˆœ weighted randomë§Œ ì‚¬ìš©
- í–¥í›„ ë²„ì „ì—ì„œ ì¶”ê°€

---

## 6. Implementation Checklist

### Phase 1: Core Implementation

- [ ] `SKILL.md` ì‘ì„±
  - [ ] Frontmatter (name, description)
  - [ ] Invocation detection logic
  - [ ] Core workflow
  - [ ] Fallback procedure

- [ ] `reference.md` ì‘ì„±
  - [ ] VS í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ (EN/KO)
  - [ ] ì–¸ì–´ ê°ì§€ ë¡œì§
  - [ ] íŒŒì‹± ë¡œì§
  - [ ] ì„ íƒ ì „ëµ ìƒì„¸

- [ ] `examples.md` ì‘ì„±
  - [ ] Explicit í˜¸ì¶œ ì˜ˆì‹œ
  - [ ] Implicit í˜¸ì¶œ + í™•ì¸ ì˜ˆì‹œ
  - [ ] --all ì˜µì…˜ ì˜ˆì‹œ
  - [ ] Fallback ì‹œë‚˜ë¦¬ì˜¤ ì˜ˆì‹œ

### Phase 2: Validation

- [ ] `./scripts/validate-templates.sh --skills` í†µê³¼
- [ ] ì‹¤ì œ í…ŒìŠ¤íŠ¸ (ë¸Œë ˆì¸ìŠ¤í† ë° ì¿¼ë¦¬)
- [ ] Fallback í…ŒìŠ¤íŠ¸ (ì˜ë„ì  íŒŒì‹± ì‹¤íŒ¨)

### Phase 3: Documentation

- [ ] README ì—…ë°ì´íŠ¸ (ìˆë‹¤ë©´)
- [ ] CLAUDE.md ìŠ¤í‚¬ ëª©ë¡ ì¶”ê°€

---

## 7. Future Enhancements (Post-MVP)

| Enhancement | Priority | Description |
|-------------|----------|-------------|
| `--merge` ì˜µì…˜ | Medium | ì—¬ëŸ¬ ì‘ë‹µ í•©ì„± |
| í”¼ë“œë°± ë£¨í”„ | Low | ì‚¬ìš©ì ì„ í˜¸ë„ í•™ìŠµ |
| ëª¨ë“ˆí™” | Medium | ë‹¤ë¥¸ ìŠ¤í‚¬ì—ì„œ import ê°€ëŠ¥í•˜ê²Œ |
| `expert-panel` í†µí•© | Low | ì „ë¬¸ê°€ ì˜ê²¬ ë‹¤ì–‘í™” |

---

## 8. Risk & Mitigation

| Risk | Impact | Mitigation |
|------|--------|------------|
| íŒŒì‹± ì‹¤íŒ¨ | High | Fallback í•„ìˆ˜ êµ¬í˜„ |
| í† í° ê³¼ë‹¤ ì†Œë¹„ | Medium | Implicit í˜¸ì¶œ ì‹œ í™•ì¸, ì í•©ì„± ê²€ì¦ |
| í™•ë¥  hallucination | Low | ì ˆëŒ€ê°’ ì•„ë‹Œ ìƒëŒ€ ìˆœìœ„ë¡œ í•´ì„ |
| í•œêµ­ì–´ í’ˆì§ˆ ì €í•˜ | Medium | í•œêµ­ì–´ ì „ìš© í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ |

---

## Approval

- [ ] ê³„íš ê²€í†  ì™„ë£Œ
- [ ] êµ¬í˜„ ì°©ìˆ˜ ìŠ¹ì¸

**Date**: 2026-01-15
**Author**: Claude (Expert Panel í† ë¡  ê²°ê³¼ ë°˜ì˜)
