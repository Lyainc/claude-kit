# Document Concretization - Reference

상세 절차 및 가이드라인.

## Table of Contents

- [Phase 1: Segmentation 상세](#phase-1-segmentation-상세)
- [Phase 2: Recursive Build 상세](#phase-2-recursive-build-상세)
- [Phase 3: Final Review 상세](#phase-3-final-review-상세)
- [Phase 4: Polish 상세](#phase-4-polish-상세)
- [Threshold 세부 기준](#threshold-세부-기준)
- [상태 추적 JSON 스키마](#상태-추적-json-스키마)

---

## Phase 1: Segmentation 상세

### 의미 단위 식별 기준

| 기준 | 설명 | 예시 |
|------|------|------|
| 독립적 개념 | 단독으로 설명 가능한 단위 | "고객 중심" vs "빠른 실행" |
| 논리적 전환점 | 주제나 관점이 바뀌는 지점 | 원인→결과, 현재→미래 |
| 구조적 구분 | 문서 형식상 분리되는 단위 | 배경/본론/결론 |

### 청크 수 결정

| 예상 분량 | 권장 청크 수 |
|----------|-------------|
| 800-1,200자 | 3개 |
| 1,200-2,000자 | 4-5개 |
| 2,000자 이상 | 5-7개 |

### 순서 결정 패턴

1. **연역적**: 원칙 → 세부 사항 → 예시
2. **귀납적**: 현상 → 분석 → 원칙 도출
3. **시간순**: 과거 → 현재 → 미래
4. **중요도순**: 핵심 → 부가 → 선택

## Phase 2: Recursive Build 상세

### Build 단계

**컨텍스트 로드 시 참조할 것**:
- 이전 섹션의 마지막 2-3문장
- 사용된 핵심 용어 목록
- 설정된 톤앤매너 (공식/비공식, 거리감 등)

**작성 원칙**:
```
1. 한 문장에 하나의 아이디어
2. 주어-술어 명확히
3. 수식어는 최소화
4. 전문 용어는 첫 등장 시 설명
```

### Verify 체크리스트

```
[논리적 연결]
□ 이전 섹션과 접속어/연결어 자연스러움
□ 개념 간 인과관계 명확
□ 비약 없음

[모순 검사]
□ 이전에 언급한 내용과 충돌 없음
□ 동일 용어의 의미 일관성
□ 수치/사실 정보 일치

[톤앤매너]
□ 문장 종결 스타일 일관
□ 경어/비경어 통일
□ 문장 길이 편차 ±10자 이내
```

### Reflect 분기

```
검증 결과 → 분기
├─ 모두 통과 → 다음 세그먼트
├─ 1-2개 실패 → 해당 부분 수정 후 재검증 (최대 2회)
├─ 3개 이상 실패 → 세그먼트 전체 재작성
└─ 팩트 불확실 → 도구 호출 또는 마킹
```

### Critical Issue 판단 기준

| 상황 | 행동 |
|------|------|
| 해석이 2가지 이상 가능 | AskUserQuestion으로 확인 |
| 외부 정보 필요 | WebFetch 시도, 실패 시 사용자에게 질문 |
| 민감한 주장 | 근거 명시 + 사용자 승인 요청 |
| 원본 문체와 괴리 | 어느 쪽을 따를지 확인 |

## Phase 3: Final Review 상세

### Self-Critique 질문 목록

```
1. 이 문서의 주장 중 근거가 약한 것은?
2. 독자가 오해할 수 있는 표현은?
3. 누락된 중요 관점이나 반론은?
4. 불필요하게 길거나 반복되는 부분은?
5. 원래 요청에서 벗어난 내용은?
```

### 의도 정렬 체크

```
원래 요청: [사용자 원문 인용]
작성 결과: [핵심 내용 요약]

정렬 상태:
□ 핵심 요청 충족
□ 범위 적절 (과잉/누락 없음)
□ 톤 일치
```

## Phase 4: Polish 상세

### LLM 특유 표현 교정 목록

| 제거 대상 | 대안 |
|----------|------|
| "매우 중요한" | "핵심적인" 또는 삭제 |
| "다양한 방법으로" | 구체적 방법 명시 또는 삭제 |
| "효과적으로" | 삭제 또는 구체적 효과 명시 |
| "성공적으로 달성" | "달성" |
| "심층적으로 분석" | "분석" |
| "폭넓게 활용" | "활용" |

### 문장 길이 조정

```
[문제] 50자 이상 문장
→ 두 문장으로 분리
→ 관계절을 별도 문장으로

[문제] 10자 미만 문장 연속
→ 앞뒤 문장과 결합 검토
```

### 문체 참조 적용

원본 문서가 있을 경우:

1. **어미 패턴 추출**: ~다/~이다 vs ~습니다/~입니다
2. **문장 평균 길이 측정**: 원본과 ±5자 이내로 맞춤
3. **자주 쓰는 접속어 파악**: 그래서/따라서/하지만 등
4. **특징적 표현 유지**: 사용자 고유의 표현이 있으면 보존

## Threshold 세부 기준

### 800자 기준 근거

| 분량 | 특성 | 스킬 적용 |
|------|------|----------|
| ~500자 | 단일 개념, 1-2 문단 | 불필요 |
| 500-800자 | 2-3 문단, 구조 단순 | 선택적 |
| **800자+** | 3+ 문단, 논리 구조 필요 | **권장** |
| 2,000자+ | 복잡한 구조, 다중 개념 | 필수 |

### Bypass 조건 상세

```
1. 명시적 단순화 요청
   - "짧게", "간단히", "한 문장으로", "요약"

2. 이미 구조화된 입력
   - 사용자가 이미 목차/구조 제시
   - 단순 번역/정리 요청

3. 단순 정의/설명
   - "X가 뭐야?", "X 설명해줘"
   - 개념 정의만 필요한 경우
```

## 상태 추적 JSON 스키마

```json
{
  "segments": [
    {"id": 1, "name": "세그먼트명", "status": "completed|in_progress|pending"},
    ...
  ],
  "current": 1,
  "style_ref": "파일명 또는 null",
  "style_notes": "추출된 문체 특성",
  "issues": [
    {"segment": 1, "type": "critical|warning", "desc": "설명", "resolved": false}
  ],
  "verify_count": {"1": 0, "2": 1, ...}
}
```
